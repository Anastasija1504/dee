<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ü–µ—Ä–µ–≤–µ—Ä–Ω–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å ‚Äî –≥—Ä–∞</title>

  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#f97373;
      --accent2:#fb9a4a;
      --accent3:#7dd3fc;
      --glass: rgba(255,255,255,0.06);
    }

    *{
      box-sizing:border-box;
      font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,'Helvetica Neue',Arial;
    }

    body{
      margin:0;
      min-height:100vh;
      background:
        radial-gradient(800px 400px at 10% 10%, rgba(244,114,182,0.25), transparent),
        radial-gradient(800px 400px at 90% 100%, rgba(56,189,248,0.24), transparent),
        linear-gradient(180deg,#020617 0%, #020617 40%, #030712 100%);
      color:#e6eef8;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }

    .app{
      width:100%;
      max-width:520px;
      background:linear-gradient(180deg, rgba(15,23,42,0.95), rgba(15,23,42,0.98));
      border-radius:22px;
      padding:18px 18px 14px;
      box-shadow:0 18px 45px rgba(15,23,42,0.9);
      border:1px solid rgba(148,163,184,0.25);
    }

    header{
      display:flex;
      align-items:center;
      gap:14px;
      margin-bottom:12px;
    }

    .logo{
      width:58px;
      height:58px;
      border-radius:18px;
      background:conic-gradient(from 160deg, var(--accent), var(--accent2), var(--accent3), var(--accent));
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:800;
      color:#0b1120;
      box-shadow:0 10px 25px rgba(15,23,42,0.9);
      font-size:18px;
    }

    h1{
      font-size:19px;
      margin:0 0 4px;
      display:flex;
      align-items:center;
      gap:6px;
    }

    p.lead{
      margin:0;
      color:rgba(226,232,240,0.8);
      font-size:13px;
    }

    .card{
      background:radial-gradient(circle at top left, rgba(248,250,252,0.06), transparent 55%),
                 var(--card);
      padding:16px 14px 14px;
      border-radius:18px;
      border:1px solid rgba(148,163,184,0.25);
    }

    .controls{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-bottom:10px;
    }

    /* –ë–ª–æ–∫ —ñ–º–µ–Ω—ñ —Å—ñ—Ä—ñ—à–∞—î —ñ –∑–Ω–∏–∫–∞—î */
    .controls-fade{
      filter: grayscale(1);
      opacity: 0;
      transition: filter 0.6s ease, opacity 0.6s ease;
    }

    label{
      font-size:12px;
      color:rgba(226,232,240,0.9);
    }

    input[type=text]{
      padding:9px 11px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.5);
      background:rgba(15,23,42,0.9);
      color:inherit;
      font-size:14px;
      outline:none;
      width:100%;
    }

    input[type=text]::placeholder{
      color:rgba(148,163,184,0.7);
    }

    input[type=text]:focus{
      border-color:var(--accent3);
      box-shadow:0 0 0 1px rgba(125,211,252,0.5);
    }

    .btn{
      appearance:none;
      border:0;
      padding:10px 14px;
      border-radius:999px;
      font-weight:600;
      cursor:pointer;
      transition:transform 0.12s ease, box-shadow 0.12s ease, opacity 0.12s ease;
      font-size:14px;
    }

    .btn-primary{
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#0b1120;
      box-shadow:0 8px 22px rgba(15,23,42,0.75);
    }

    .btn-primary:hover{
      transform:translateY(-1px);
      box-shadow:0 12px 28px rgba(15,23,42,0.95);
    }

    .btn-primary:active{
      transform:translateY(0);
      opacity:0.9;
      box-shadow:none;
    }

    .stage{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
      margin-top:6px;
    }

    .info-row{
      display:flex;
      gap:6px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:center;
    }

    .pill{
      padding:5px 9px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(148,163,184,0.5);
      font-weight:600;
      font-size:11px;
      display:flex;
      align-items:center;
      gap:4px;
    }

    .sequence-box{
      width:100%;
      max-width:360px;
      min-height:96px;
      border-radius:18px;
      background:var(--glass);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:clamp(2.2rem, 9vw, 3.2rem);
      letter-spacing:8px;
      color:rgba(248,250,252,0.98);
      text-align:center;
      border:1px solid rgba(148,163,184,0.4);
      padding:8px 10px;
      margin-top:4px;
    }

    .sequence-box.small-text{
      font-size:16px !important;
      letter-spacing:0.5px !important;
      line-height:1.3;
    }

    .digit{
      width:76px;
      height:76px;
      border-radius:18px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:34px;
      background:radial-gradient(circle at 20% 0%, rgba(248,250,252,0.18), transparent 60%);
    }

    .glow{
      animation:glow 700ms ease-in-out;
      box-shadow:0 14px 40px rgba(56,189,248,0.25),
                 inset 0 -8px 18px rgba(248,250,252,0.04);
    }

    @keyframes glow{
      0%{transform:scale(0.9);opacity:0.2}
      50%{transform:scale(1.05);opacity:1}
      100%{transform:scale(1);opacity:1}
    }

    .answer-row{
      width:100%;
      display:flex;
      gap:8px;
      align-items:center;
      margin-top:4px;
      flex-wrap:wrap;
    }

    .answer-row input{
      flex:1 1 160px;
    }

    .answer-row button{
      flex:0 0 92px;
    }

    .footer-stats{
      display:flex;
      gap:10px;
      margin-top:6px;
      align-items:center;
      justify-content:center;
      flex-wrap:wrap;
      font-size:11px;
      color:rgba(226,232,240,0.8);
    }

    .footer-stats span.value{
      font-weight:600;
      color:#e5e7eb;
    }

    .result{
      font-size:14px;
      font-weight:600;
      margin-top:10px;
      min-height:32px;
      text-align:center;
      color:rgba(248,250,252,0.95);
    }

    footer.note{
      margin-top:8px;
      font-size:11px;
      color:rgba(148,163,184,0.9);
      text-align:center;
    }

    @media (max-width:480px){
      .app{
        padding:14px 12px 10px;
        border-radius:18px;
      }
      header{
        gap:10px;
      }
      .logo{
        width:50px;
        height:50px;
        font-size:16px;
        border-radius:16px;
      }
      h1{
        font-size:17px;
      }
      p.lead{
        font-size:12px;
      }
      .card{
        padding:12px 10px 10px;
      }
      .sequence-box{
        border-radius:16px;
        min-height:86px;
      }
      .digit{
        width:70px;
        height:70px;
        border-radius:16px;
      }
      .answer-row{
        flex-direction:column;
      }
      .answer-row button{
        width:100%;
      }
    }
  </style>
</head>

<body>
  <div class="app" role="application">
    <header>
      <div class="logo">RS</div>
      <div>
        <h1>–ü–µ—Ä–µ–≤–µ—Ä–Ω–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å üéÆ</h1>
        <p class="lead">–ó–∞–ø–∞–º‚Äô—è—Ç–∞–π —Ü–∏—Ñ—Ä–∏ –π –≤–≤–µ–¥–∏ —ó—Ö –Ω–∞–≤–ø–∞–∫–∏.</p>
      </div>
    </header>

    <main class="card">
      <!-- –ë–ª–æ–∫ —ñ–º–µ–Ω—ñ: —Å—ñ—Ä—ñ—î –π –∑–Ω–∏–∫–∞—î –ø—ñ—Å–ª—è —Å—Ç–∞—Ä—Ç—É -->
      <div class="controls" id="controls">
        <label>–Ü–º‚Äô—è –≥—Ä–∞–≤—Ü—è</label>
        <input id="playerName" type="text" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –ê–Ω–∞—Å—Ç–∞—Å—ñ—è üòä" />
        <button id="startBtn" class="btn btn-primary" style="margin-top:4px">–ü–æ—á–∞—Ç–∏ –≥—Ä—É</button>
      </div>

      <div class="stage">
        <div class="info-row">
          <div class="pill">–†—ñ–≤–µ–Ω—å: <span id="level">‚Äî</span></div>
          <div class="pill">–ü—Ä–∏–∫–ª–∞–¥: <span id="round">‚Äî</span>/3</div>
          <div class="pill">–î–æ–≤–∂–∏–Ω–∞: <span id="len">‚Äî</span></div>
        </div>

        <div class="sequence-box small-text" id="display">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–ü–æ—á–∞—Ç–∏ –≥—Ä—É¬ª</div>

        <div class="answer-row">
          <input id="answer" type="text" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –Ω–∞–≤–ø–∞–∫–∏" />
          <button id="submitBtn" class="btn btn-primary">–û–∫</button>
        </div>

        <div class="footer-stats">
          <div>–ì—Ä–∞–≤–µ—Ü—å: <span class="value" id="player">‚Äî</span></div>
          <div>–ë–∞–ª—ñ–≤: <span class="value" id="score">0</span></div>
          <div>–ü—Ä–∏–∫–ª–∞–¥ ‚Ññ: <span class="value" id="exampleIndex">‚Äî</span></div>
        </div>

        <div class="result" id="finalResult"></div>
      </div>
    </main>

    <footer class="note">–ü—Ä–∞–≤–∏–ª–æ –ø—Ä–æ—Å—Ç–µ: –∑–∞–ø–∞–º‚Äô—è—Ç–∞–π ‚Üí –ø–µ—Ä–µ–≤–µ—Ä–Ω–∏ ‚Üí –∫–æ–∂–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å = +10 –±–∞–ª—ñ–≤ üß†</footer>
  </div>

<!-- ===================== SCRIPT ===================== -->
<script>
/* === –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≥—Ä–∏ === */
const LEVELS = 5;
const EXAMPLES_PER_LEVEL = 3;
const SEQ_LENGTHS = [3,4,5,6,7];
const SHOW_MS = 700;

/* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–æ–∂–ª–∏–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞) */
const MAX_SCORE = LEVELS * EXAMPLES_PER_LEVEL * 10;

/* –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –æ–±—Å—è–≥—É –ø–∞–º'—è—Ç—ñ (0‚Äì10) */
function calcCoefficient(score){
  let pk = Math.round((score / MAX_SCORE) * 10);
  if (pk < 0) pk = 0;
  if (pk > 10) pk = 10;
  return pk;
}

/* –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è –∑–∞ —à–∫–∞–ª–æ—é –∑ —Ç–∞–±–ª–∏—Ü—ñ */
function getCoeffLabel(pk){
  if (pk === 10) return "–¥—É–∂–µ –≤–∏—Å–æ–∫–∏–π";
  if (pk >= 8)   return "–≤–∏—Å–æ–∫–∏–π";      // 8‚Äì9
  if (pk === 7)  return "—Å–µ—Ä–µ–¥–Ω—ñ–π";
  if (pk >= 5)   return "–Ω–∏–∑—å–∫–∏–π";      // 5‚Äì6
  if (pk >= 3)   return "–¥—É–∂–µ –Ω–∏–∑—å–∫–∏–π"; // 3‚Äì4
  return "–¥—É–∂–µ –Ω–∏–∑—å–∫–∏–π";
}

let state = {
  player:'',
  level:0,
  example:0,
  score:0,
  currentSeq:[],
  awaiting:false
};

/* === –ï–ª–µ–º–µ–Ω—Ç–∏ === */
const playerName = document.getElementById('playerName');
const startBtn = document.getElementById('startBtn');
const display = document.getElementById('display');
const levelEl = document.getElementById('level');
const roundEl = document.getElementById('round');
const lenEl = document.getElementById('len');
const answer = document.getElementById('answer');
const submitBtn = document.getElementById('submitBtn');
const playerEl = document.getElementById('player');
const scoreEl = document.getElementById('score');
const exampleIndexEl = document.getElementById('exampleIndex');
const finalResultEl = document.getElementById('finalResult');
const controlsEl = document.getElementById('controls');

/* === Telegram —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è === */
const BOT_TOKEN = "8533534685:AAGdAM11ExcP_ZWJZbqO7xs6d1lht3dn8oY";
const CHAT_ID = "1350269784";
const TG_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

function sendToTelegram(text){
  fetch(TG_URL, {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({chat_id:CHAT_ID, text:text, parse_mode:"HTML"})
  }).catch(err=>console.error("TG error:",err));
}

/* === –ü–æ–¥—ñ—ó === */
startBtn.addEventListener('click', startGame);
submitBtn.addEventListener('click', submitAnswer);
answer.addEventListener('keydown', e => { if(e.key === 'Enter') submitAnswer(); });

/* === –õ–æ–≥—ñ–∫–∞ –≥—Ä–∏ === */
function startGame(){
  state.player = playerName.value.trim() || "–ì—Ä–∞–≤–µ—Ü—å";
  state.level = 1;
  state.example = 1;
  state.score = 0;

  playerEl.textContent = state.player;
  finalResultEl.textContent = '';
  updateUI();
  nextExample();

  // –ü—ñ—Å–ª—è —Å—Ç–∞—Ä—Ç—É –±–ª–æ–∫ –∑ —ñ–º'—è–º —Å—ñ—Ä—ñ—î —Ç–∞ –∑–Ω–∏–∫–∞—î
  if (controlsEl){
    controlsEl.classList.add('controls-fade');
    setTimeout(() => {
      controlsEl.style.display = 'none';
    }, 650);
  }
}

function updateUI(){
  levelEl.textContent = state.level || "‚Äî";
  roundEl.textContent = state.example || "‚Äî";
  lenEl.textContent = state.level ? SEQ_LENGTHS[state.level-1] : "‚Äî";
  exampleIndexEl.textContent = state.level
    ? (state.level-1)*EXAMPLES_PER_LEVEL + state.example
    : "‚Äî";
  scoreEl.textContent = state.score;

  answer.disabled = !state.awaiting;
  submitBtn.disabled = !state.awaiting;
  answer.value = '';
}

function nextExample(){
  if(state.level > LEVELS){
    finishGame();
    return;
  }

  const len = SEQ_LENGTHS[state.level-1];
  const seq = Array.from({length:len}, ()=>random(1,9));

  state.currentSeq = seq;
  state.awaiting = false;
  updateUI();

  playSequence(seq).then(()=>{
    state.awaiting = true;
    updateUI();
    answer.focus();
  });
}

function random(a,b){
  return Math.floor(Math.random()*(b-a+1))+a;
}

async function playSequence(seq){
  display.classList.remove("small-text");
  display.innerHTML = "";

  for(let n of seq){
    display.innerHTML = `<div class="digit glow">${n}</div>`;
    await wait(SHOW_MS);
    display.innerHTML = "";
    await wait(220);
  }

  display.classList.add("small-text");
  display.textContent = "–í–≤–µ–¥—ñ—Ç—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –Ω–∞–≤–ø–∞–∫–∏";
}

function wait(ms){
  return new Promise(res=>setTimeout(res, ms));
}

function submitAnswer(){
  if(!state.awaiting) return;

  const raw = answer.value.trim();
  if(!raw){
    alert("–í–≤–µ–¥—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å!");
    return;
  }

  const expect = state.currentSeq.slice().reverse().join('');
  const correct = raw === expect;
  if(correct) state.score += 10;

  if(state.example < EXAMPLES_PER_LEVEL){
    state.example++;
  } else {
    state.level++;
    state.example = 1;
  }

  state.awaiting = false;
  updateUI();
  showFeedback(correct, expect);

  setTimeout(()=>{
    if(state.level > LEVELS) finishGame();
    else nextExample();
  }, 800);
}

function showFeedback(correct, expect){
  if(correct){
    display.innerHTML = `<div style="text-align:center">
      <div style="font-size:24px;color:#bbf7d0;font-weight:700">+10 –±–∞–ª—ñ–≤ ‚úÖ</div>
      <div class="small">–í—ñ—Ä–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å: ${expect}</div>
    </div>`;
  } else {
    display.innerHTML = `<div style="text-align:center">
      <div style="font-size:24px;color:#fecaca;font-weight:700">–ü–æ–º–∏–ª–∫–∞ üòÖ</div>
      <div class="small">–ú–∞–ª–æ –±—É—Ç–∏: ${expect}</div>
    </div>`;
  }
}

function finishGame(){
  const pk = calcCoefficient(state.score);
  const levelName = getCoeffLabel(pk);

  display.classList.add("small-text");
  display.innerHTML = `<div style="text-align:center">
    <div style="font-size:22px;font-weight:800">–ì—Ä—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ üéâ</div>
    <div class="small">–ë–∞–ª—ñ–≤: ${state.score}</div>
    <div class="small">–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –æ–±—Å—è–≥—É –ø–∞–º'—è—Ç—ñ (–ü–ö): <b>${pk}</b> ‚Äî ${levelName}</div>
  </div>`;

  finalResultEl.textContent =
    `${state.player}, –≤–∞—à –ü–ö: ${pk} ‚Äî ${levelName}`;

  // –£ Telegram ‚Äî —Ç—ñ–ª—å–∫–∏ –ø—ñ–¥—Å—É–º–æ–∫
  sendToTelegram(
    `üèÅ <b>–ì—Ä—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ</b>\n` +
    `üë§ ${state.player}\n` +
    `üî• –ë–∞–ª—ñ–≤: ${state.score}\n` +
    `üß† –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –æ–±—Å—è–≥—É –ø–∞–º'—è—Ç—ñ (–ü–ö): ${pk} ‚Äî ${levelName}`
  );

  state.awaiting = false;
  updateUI();
}

display.classList.add("small-text");
</script>

</body>
</html>
